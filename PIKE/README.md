# Pike PoC

☕ **Fueling DevOps ideas with smarter IAM policies.**

## What is Pike?

**Pike** is an open-source tool designed to analyze Infrastructure as Code (IaC) and generate IAM policies that match the permissions required by the code. This helps automate the creation of least-privilege IAM policies, improving security and saving time.

### Key Features:
- Automatically generates IAM policies based on your IaC.
- Compares deployed IAM configurations with those defined in IaC.
- Inspects your environment to ensure IAM policies align with best practices.
- Works with popular IaC tools like Terraform.

For more details, visit the [official documentation](https://github.com/JamesWoolfenden/pike).

---

## Installation

I installed Pike using Homebrew:

```bash
brew install jameswoolfenden/tap/pike
```

Verify the installation:
```bash
pike --version
```

----

# RUNNING 

To test Pike, I ran the following command in the root directory of my Terraform environment:
```bash
pike make -d .
```

### What Happened?

1. Pike analyzed the Terraform configuration in the current directory.
2. It identified a module for **Kinesis** and determined the necessary IAM permissions.
3. Pike generated the **best-fit IAM policy** and saved it in a directory called **`.pike`**.

### Example of Generated Files:

- **IAM Policy**: `aws_iam_policy` resource with actions specific to Kinesis.
- **IAM Role**: A role to assume the generated policy.
- **IAM Role Policy Attachment**: Links the role to the policy for proper permissions.

The generated files are ready to be used and can be applied via Terraform.

---

### Example Generated Policy

Here is a snippet of the IAM policy generated by Pike:
```hcl
resource "aws_iam_policy" "terraform_pike" {
  name_prefix = "terraform_pike"
  path        = "/"
  description = "Pike Autogenerated policy from IAC"

  policy = jsonencode({
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "VisualEditor1",
            "Effect": "Allow",
            "Action": [
                "kinesis:AddTagsToStream",
                "kinesis:CreateStream",
                "kinesis:DeleteStream",
                "kinesis:DescribeStreamSummary",
                "kinesis:EnableEnhancedMonitoring",
                "kinesis:UpdateShardCount"
            ],
            "Resource": ["*"]
        }
    ]
  })
}
```

You can find the generated files in the **`.pike`** directory:
[View Generated Files](./.pike)


### Benefits of Using Pike

- **Time-Saving**: Automates the process of writing IAM policies for your IaC.
- **Improved Security**: Helps create least-privilege IAM policies, reducing over-permissioning.
- **Documentation**: Automatically generates IAM configurations, making it easier to review and audit.

---

☕ *Happy IAM policy generation and secure infrastructure building!*